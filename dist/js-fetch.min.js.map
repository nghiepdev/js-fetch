{"version":3,"sources":["../src/js-fetch.js"],"names":[],"mappings":"oEAAA,4BAEM,OAFN,CAIM,QAAW,QAAX,QAAW,CAAS,CAAT,CAAc,CAAd,CAAuB,CACtC,MAAO,IAAI,QAAJ,CAAY,SAAC,CAAD,CAAU,CAAV,CAAqB,CACd,WAApB,QAAO,SAD2B,CAmCpC,EAAO,GAAI,MAAJ,CAAU,wCAAV,CAAP,CAnCoC,CAE/B,KAAK,QAAL,CAAc,CAAd,CAF+B,CAmB9B,CAnB8B,CAoBhC,iBAAM,CAAE,MAAO,OAAO,gBAAhB,CAAN,CAA0C,WAAY,CAChD,OAAO,CAAP,CADgD,CAElD,EAAS,IAAT,CAAe,OAAO,CAAP,CAAf,CAFkD,CAIlD,EAAS,GAAI,MAAJ,CAAU,yBAA2B,CAArC,CAAT,CAEH,CAND,CAMG,SAAC,CAAD,CAAM,CAAN,CAAiB,CAClB,GAAO,EAAO,CAAP,CADW,CAElB,EAAQ,CAAR,CACD,CATD,CApBgC,CA+BhC,GA/BgC,YAGlC,GAAM,GAAK,SAAS,aAAT,CAAuB,QAAvB,CAAX,CACA,EAAG,KAAH,GAJkC,CAKlC,EAAG,GAAH,CAAS,CALyB,CAMlC,EAAG,OAAH,CAAa,EAAG,MAAH,CAAY,WAAO,CAC1B,GAAoB,OAAb,KAAI,IADe,GAE5B,EAAG,MAAH,EAF4B,CAG5B,EAAO,CAAP,CAH4B,EAK1B,CAL0B,EAM5B,EAAQ,OAAO,CAAP,CAAR,CAN4B,CAQ9B,GACD,CAfiC,CAgBlC,SAAS,IAAT,CAAc,WAAd,CAA0B,CAA1B,CAhBkC,CAiBlC,KAAK,IAAL,CAAU,CAAV,CAjBkC,GAqCvC,CArCM,CAsCR,CA3CD,C,gBA4Ce,O,CAEV,OAAO,O,GACV,OAAO,OAAP,CAAiB,O","file":"js-fetch.min.js","sourcesContent":["import { retry } from 'async';\n\nconst urls = [];\n\nconst jsFetch =  function(url, waitVar) {\n  return new Promise((resolve, reject) => {\n    if (typeof document !== 'undefined') {\n      if (!urls.includes(url)) {\n        const el = document.createElement('script');\n        el.async = true;\n        el.src = url;\n        el.onerror = el.onload = err => {\n          if (err && err.type === 'error') {\n            el.remove();\n            reject(err);\n          }\n          if (waitVar) {\n            resolve(window[waitVar]);\n          }\n          resolve();\n        };\n        document.body.appendChild(el);\n        urls.push(url);\n      } else {\n        if (waitVar) {\n          retry({ times: Number.MAX_SAFE_INTEGER }, callback => {\n            if (window[waitVar]) {\n              callback(null, window[waitVar]);\n            } else {\n              callback(new Error('Cannot found variable ' + waitVar));\n            }\n          }, (err, result) => {\n            err && reject(err);\n            resolve(result);\n          });\n        } else {\n          resolve();\n        }\n      }\n    } else {\n      reject(new Error('This package is not called during SSR.'));\n    }\n  });\n}\nexport default jsFetch;\n\nif (!global.jsFetch) {\n  global.jsFetch = jsFetch;\n}\n"]}