{"version":3,"sources":["../src/js-fetch.js"],"names":[],"mappings":"wTAIe,SAAS,CAAT,CAAc,CAAd,CAAwC,IAAjB,EAAiB,2DACrD,MAAO,IAAI,QAAJ,CAAY,SAAC,CAAD,CAAU,CAAV,CAAqB,CACd,WAApB,QAAO,SAD2B,CAyCpC,EAAO,GAAI,MAAJ,CAAU,wCAAV,CAAP,CAzCoC,CAE/B,KAAK,QAAL,CAAc,CAAd,CAF+B,CAyB9B,CAzB8B,CA0BhC,iBAAM,CAAE,MAAO,OAAO,gBAAhB,CAAN,CAA0C,WAAY,CAChD,OAAO,CAAP,CADgD,CAElD,EAAS,IAAT,CAAe,OAAO,CAAP,CAAf,CAFkD,CAIlD,EAAS,GAAI,MAAJ,CAAU,yBAA2B,CAArC,CAAT,CAEH,CAND,CAMG,SAAC,CAAD,CAAM,CAAN,CAAiB,CAClB,GAAO,EAAO,CAAP,CADW,CAElB,EAAQ,CAAR,CACD,CATD,CA1BgC,CAqChC,GArCgC,YAGlC,GAAM,GAAK,SAAS,aAAT,CAAuB,QAAvB,CAAX,CAGA,GAFA,EAAG,KAAH,GAEA,CAA0B,QAAtB,sBAAO,EAAP,qBAAO,CAAP,IAAkC,CAAC,MAAM,OAAN,CAAc,CAAd,CAAvC,CACE,IAAI,GAAM,IAAV,GAAe,EAAf,CACE,EAAG,GAAH,EAAQ,EAAW,GAAX,CADV,CAKF,EAAG,OAAH,CAAa,EAAG,MAAH,CAAY,WAAO,CAC1B,GAAoB,OAAb,KAAI,IADe,GAE5B,EAAG,MAAH,EAF4B,CAG5B,EAAO,CAAP,CAH4B,EAK1B,CAL0B,EAM5B,EAAQ,OAAO,CAAP,CAAR,CAN4B,CAQ9B,GACD,CArBiC,CAsBlC,SAAS,IAAT,CAAc,WAAd,CAA0B,CAA1B,CAtBkC,CAuBlC,KAAK,IAAL,CAAU,CAAV,CAvBkC,GA2CvC,CA3CM,CA4CR,C,CAjDD,4BAEM,OAFN,C","file":"js-fetch.min.js","sourcesContent":["import { retry } from 'async';\n\nconst urls = [];\n\nexport default function(url, waitVar, attributes = {}) {\n  return new Promise((resolve, reject) => {\n    if (typeof document !== 'undefined') {\n      if (!urls.includes(url)) {\n        const el = document.createElement('script');\n        el.async = true;\n        \n        if (typeof attributes === 'object' && !Array.isArray(attributes)) {\n          for(const i in attributes) {\n            el[i] = attributes[i];\n          }\n        }\n        \n        el.onerror = el.onload = err => {\n          if (err && err.type === 'error') {\n            el.remove();\n            reject(err);\n          }\n          if (waitVar) {\n            resolve(window[waitVar]);\n          }\n          resolve();\n        };\n        document.body.appendChild(el);\n        urls.push(url);\n      } else {\n        if (waitVar) {\n          retry({ times: Number.MAX_SAFE_INTEGER }, callback => {\n            if (window[waitVar]) {\n              callback(null, window[waitVar]);\n            } else {\n              callback(new Error('Cannot found variable ' + waitVar));\n            }\n          }, (err, result) => {\n            err && reject(err);\n            resolve(result);\n          });\n        } else {\n          resolve();\n        }\n      }\n    } else {\n      reject(new Error('This package is not called during SSR.'));\n    }\n  });\n}\n"]}